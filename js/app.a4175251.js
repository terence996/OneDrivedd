(function(){"use strict";var __webpack_modules__={9132:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var vue__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3396),vue__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7139),vue__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4870),_components_Icon_vue__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3449);const _hoisted_1={class:"box"},_hoisted_2={class:"card"},_hoisted_3=(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("控制面板 "),_hoisted_4=(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("从OneDrive选择文件 "),_hoisted_5=(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("额外创建分享链接（配合1drv.ws使用） "),_hoisted_6={class:"mask"},_hoisted_7=["onClick"],_hoisted_8={class:"mask"},_hoisted_9={class:"card out"},_hoisted_10=(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("输出面板 "),_hoisted_11={class:"tip"},_hoisted_12={class:"mask"},_hoisted_13=["onClick"],_hoisted_14=(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",{class:"copyright"},[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)(" Copyright © 2017 "),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("a",{href:"https://github.com/Mapaler/GetOneDriveDirectLink",target:"_blank"},"枫谷剑仙"),(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)(" 版权所有，本程序源代码使用GPLv3协议公开 "),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("br"),(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("Mapaler all right reserved. Source public by GPLv3. "),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",{class:"hr"}),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("p",null,[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)(" 使用 Vue3 进行二次开发与美化 by 2022 "),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("a",{href:"https://github.com/SpectreGao/GetOneDriveDirectLink_Code",target:"_blank"},"SpectreGao"),(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("，如有侵权，将第一时间删除 ")])],-1);__webpack_exports__["Z"]={__name:"App",setup(__props){const selectIndex=(0,vue__WEBPACK_IMPORTED_MODULE_2__.iH)(0),msg=(0,vue__WEBPACK_IMPORTED_MODULE_2__.iH)("点击按钮从OneDrive选择文件"),result=(0,vue__WEBPACK_IMPORTED_MODULE_2__.iH)([]),redata=(0,vue__WEBPACK_IMPORTED_MODULE_2__.iH)(null),launchOneDrivePicker=(e="query")=>{msg.value="正在等待API返回数据",Alert("正在等待API返回数据");let _={clientId:"7825abd8-ef59-4a80-865e-07ea1784d20c",action:e,multiSelect:!0,openInNewWindow:!0,advanced:{queryParameters:"select=audio,content,createdBy,createdDateTime,cTag,deleted,description,eTag,file,fileSystemInfo,folder,id,image,lastModifiedBy,lastModifiedDateTime,location,malware,name,package,parentReference,photo,publication,remoteItem,root,searchResult,shared,sharepointIds,size,specialFolder,video,webDavUrl,webUrl,activities,children,listItem,permissions,thumbnails,versions,@microsoft.graph.conflictBehavior,@microsoft.graph.downloadUrl,@microsoft.graph.sourceUrl"},success:function(e){redata.value=e,console.log("本次返回 %d 个文件，数据为 %o",redata.value.value.length,redata.value),generate_output(redata.value)},cancel:()=>{msg.value="取消操作",Alert("取消操作")},error:function(e){msg.value="发生错误",Alert("发生错误"),result.value=e.toString()}};OneDrive.open(_)},generate_output=e=>{let _=maskCfg[selectIndex.value],t=e.value;msg.value="共选择 "+t.length+" 个文件。",Alert("共选择 "+t.length+" 个文件。"),t.some((function(e){return void 0==e.shared||"anonymous"!=e.shared.scope}))&&(msg.value+="存在非公共权限文件，注意添加通行许可代码。");let r=t.map((function(e,t){let r=showMask(_.cfg,e,t);return r}));result.value=r},showMask=(str,file,index)=>{var newTxt=eval("`"+str+"`"),pattern="%{([^}]+)}",rs=null;while(null!=(rs=new RegExp(pattern).exec(newTxt))){var mskO=rs[0],mskN=rs[1];if(void 0!=mskN){mskN=void 0!=mskN?mskN.replace(/\\{/gi,"{").replace(/\\}/gi,"}").replace(/\\\\/gi,"\\"):null;try{var evTemp=eval(mskN);newTxt=void 0!=evTemp?newTxt.replace(mskO,evTemp.toString()):newTxt.replace(mskO,"")}catch(e){msg.value="掩码异常，详情查看控制台",Alert("掩码异常，详情查看控制台"),console.error(mskO+" 掩码出现了异常情况",e)}}}return newTxt},selectChange=e=>{selectIndex.value=e,redata.value&&generate_output(redata.value)},maskCfg=[{name:"普通外链",cfg:"http://storage.live.com/items/${file.id}:/${file.name}"},{name:"最短链接",cfg:"http://storage.live.com/items/${file.id}"},{name:"UBB代码外链图片",cfg:"[img]http://storage.live.com/items/${file.id}:/${file.name}[/img]"},{name:"模板字符串基本使用示例",cfg:"在OneDrive里查看 ${file.name} 的地址是：${file.webUrl}"},{name:"表达式使用示例",cfg:'${index+1}号文件的尺寸是：${file.size>1024?Math.round(file.size/1024)+"K":file.size}B'},{name:"自动选择img/mp3 UBB代码",cfg:'[${file.image?"img":(file.audio?"mp3":"file")}]http://storage.live.com/items/${file.id}:/${file.name}[/${file.image?"img":(file.audio?"mp3":"file")}]'},{name:"ES6完整文件尺寸换算示例",cfg:'${index+1}号文件的尺寸是：${(function(size){const bArr = ["B","KiB","MiB","GiB","TiB"];for(let idx=0;idx<bArr.length;idx++){if(idx<bArr.length && size/Math.pow(1024,idx+1)>1)continue;else return (size/Math.pow(1024,idx)).toFixed(2) + " " + bArr[idx];}})(file.size)}'},{name:"ES6闭包函数示例1",cfg:'文件的权限是：${(scope=>{switch(scope){case "anonymous":return "所有人";case "users":return "仅限指定用户";default:return "私有";}})(file.shared?file.shared.scope:null)}'},{name:"ES6闭包函数示例2",cfg:'文件年份：${(createTime=>new Date(createTime).toLocaleString(\'zh-u-ca-chinese-nu-hanidec\',{year:"numeric",month:"long"}))(file.createdDateTime)}'},{name:"官方图片下载直连（短期？）",cfg:'${file["@microsoft.graph.downloadUrl"].replace(/public.w+.files/i,"public.ch.files")}'}],copylink=e=>{let _,t="";if("string"==typeof e)_=document.createElement("input"),document.body.appendChild(_),_.setAttribute("value",e);else{for(var r=0;r<e.length;r++)t+=e[r]+"\n";_=document.createElement("textarea"),document.body.appendChild(_),_.value=t}_.select(),document.execCommand("copy"),Alert("链接已复制到剪贴板！"),_.remove()};(0,vue__WEBPACK_IMPORTED_MODULE_0__.bv)((()=>{if("https:"!=location.protocol&&"localhost"!=location.hostname&&""!=location.hostname){var e=confirm("检测到你正在使用http模式，本应用要求使用https模式。\n是否自动跳转？");e&&(location.protocol="https:")}}));const Alert=e=>{!$("#SpectreAlert").length>0&&$("<div id=\"SpectreAlert\"><style>#SpectreAlert {position: fixed;z-index: 99999;top: 20px;right: 20px}#SpectreAlert>div {width: 350px !important;height: auto;display: none;padding: 10px 30px;background: rgba(255, 255, 255, .7);backdrop-filter: blur(5px);border: 1px solid #ddd;border-radius: 4px;box-shadow: 0 0 5px #ccc;margin-bottom: 12px;text-align: center;color: #555;position: relative;font-size: 13px;cursor: pointer;white-space: normal !important;text-overflow: clip !important;overflow: visible !important;animation: SMP_Show .8s;}@keyframes SMP_Show {0% {opacity: 0;transform: scale(.8) translateX(100%);}80%{transform: scale(.95) translateX(0%);}100% {opacity: 1;transform: scale(1) translateX(0%);}}.SpectreAlertClose {position: absolute;top: 50%;transform: translateY(-50%);right: 10px;padding: 10px 2px;transition: .3s}.SpectreAlertClose:hover {background: #eee;border-radius: 3px;}.SpectreAlertClose:active {background: #ddd;}.SpectreAlertClose::before,.SpectreAlertClose::after {content: '';width: 14px;height: 1px;background: gray;display: block}.SpectreAlertClose::before {transform: rotate(45deg)}.SpectreAlertClose::after {transform: translateY(-1px) rotate(-45deg)}</style></div>").appendTo(document.body);let _=(new Date).toLocaleTimeString();$(`<div>[${_}] ${e}<span class="SpectreAlertClose"></span></div>`).prependTo("#SpectreAlert").fadeToggle("slow",(function(){$(".SpectreAlertClose").click((function(){$(this).parent().fadeToggle("fast",(function(){$(this).remove()}))})),setTimeout((()=>{$(this).fadeToggle("slow",(function(){$(this).remove()}))}),3e3)}))};return(e,_)=>((0,vue__WEBPACK_IMPORTED_MODULE_0__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_0__.iD)("div",_hoisted_1,[(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",_hoisted_2,[(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("h3",null,[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Wm)(_components_Icon_vue__WEBPACK_IMPORTED_MODULE_1__.Z,{icon:"Microsoft",size:"24",color:"#488ded"}),_hoisted_3]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",null,[(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("button",{onClick:_[0]||(_[0]=e=>launchOneDrivePicker("query"))},[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Wm)(_components_Icon_vue__WEBPACK_IMPORTED_MODULE_1__.Z,{icon:"Cloud"}),_hoisted_4]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("button",{onClick:_[1]||(_[1]=e=>launchOneDrivePicker("share"))},[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Wm)(_components_Icon_vue__WEBPACK_IMPORTED_MODULE_1__.Z,{icon:"Share"}),_hoisted_5])]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("ul",_hoisted_6,[((0,vue__WEBPACK_IMPORTED_MODULE_0__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_0__.iD)(vue__WEBPACK_IMPORTED_MODULE_0__.HY,null,(0,vue__WEBPACK_IMPORTED_MODULE_0__.Ko)(maskCfg,((e,_)=>(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("li",{key:_,class:(0,vue__WEBPACK_IMPORTED_MODULE_3__.C_)(selectIndex.value==_?"active":""),onClick:e=>selectChange(_)},(0,vue__WEBPACK_IMPORTED_MODULE_3__.zw)(e.name),11,_hoisted_7))),64))]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",_hoisted_8,[(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("p",null,(0,vue__WEBPACK_IMPORTED_MODULE_3__.zw)(maskCfg[selectIndex.value].cfg),1)])]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",_hoisted_9,[(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("h3",null,[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Wm)(_components_Icon_vue__WEBPACK_IMPORTED_MODULE_1__.Z,{icon:"Microsoft",size:"24",color:"#488ded"}),_hoisted_10]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",_hoisted_11,(0,vue__WEBPACK_IMPORTED_MODULE_3__.zw)(msg.value),1),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("ul",_hoisted_12,[((0,vue__WEBPACK_IMPORTED_MODULE_0__.wg)(!0),(0,vue__WEBPACK_IMPORTED_MODULE_0__.iD)(vue__WEBPACK_IMPORTED_MODULE_0__.HY,null,(0,vue__WEBPACK_IMPORTED_MODULE_0__.Ko)(result.value,((e,_)=>((0,vue__WEBPACK_IMPORTED_MODULE_0__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_0__.iD)("li",{key:_,onClick:_=>copylink(e)},(0,vue__WEBPACK_IMPORTED_MODULE_3__.zw)(e),9,_hoisted_13)))),128))]),result.value.length?((0,vue__WEBPACK_IMPORTED_MODULE_0__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_0__.iD)("button",{key:0,onClick:_[2]||(_[2]=e=>copylink(result.value))},"全部复制")):(0,vue__WEBPACK_IMPORTED_MODULE_0__.kq)("",!0),_hoisted_14])]))}}},6230:function(e,_,t){var r=t(9242),i=t(9132);const o=i.Z;var a=o;(0,r.ri)(a).mount("#app")},3449:function(e,_,t){t.d(_,{Z:function(){return l}});var r=t(3396);const i=["width","height","innerHTML","fill"];var o={__name:"Icon",props:{icon:{type:String,default:""},size:{type:String,default:"16"},color:{type:String,default:"#fff"}},setup(e){const _={Microsoft:'<path d="M11.5 3v8.5H3V3h8.5zm0 18H3v-8.5h8.5V21zm1-18H21v8.5h-8.5V3zm8.5 9.5V21h-8.5v-8.5H21z""/>',Cloud:'<path d="M17 21H7A6 6 0 0 1 5.008 9.339a7 7 0 1 1 13.984 0A6 6 0 0 1 17 21zm0-12a5 5 0 1 0-9.994.243l.07 1.488-1.404.494A4.002 4.002 0 0 0 7 19h10a4 4 0 1 0-3.796-5.265l-1.898-.633A6.003 6.003 0 0 1 17 9z"/>',Share:'<path d="M13.12 17.023l-4.199-2.29a4 4 0 1 1 0-5.465l4.2-2.29a4 4 0 1 1 .959 1.755l-4.2 2.29a4.008 4.008 0 0 1 0 1.954l4.199 2.29a4 4 0 1 1-.959 1.755zM6 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm11-6a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 12a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/>'};return(t,o)=>((0,r.wg)(),(0,r.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:e.size,height:e.size,innerHTML:_[e.icon],fill:e.color},null,8,i))}},a=t(89);const n=(0,a.Z)(o,[["__scopeId","data-v-553c0b5c"]]);var l=n}},__webpack_module_cache__={};function __webpack_require__(e){var _=__webpack_module_cache__[e];if(void 0!==_)return _.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.m=__webpack_modules__,function(){var e=[];__webpack_require__.O=function(_,t,r,i){if(!t){var o=1/0;for(c=0;c<e.length;c++){t=e[c][0],r=e[c][1],i=e[c][2];for(var a=!0,n=0;n<t.length;n++)(!1&i||o>=i)&&Object.keys(__webpack_require__.O).every((function(e){return __webpack_require__.O[e](t[n])}))?t.splice(n--,1):(a=!1,i<o&&(o=i));if(a){e.splice(c--,1);var l=r();void 0!==l&&(_=l)}}return _}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[t,r,i]}}(),function(){__webpack_require__.n=function(e){var _=e&&e.__esModule?function(){return e["default"]}:function(){return e};return __webpack_require__.d(_,{a:_}),_}}(),function(){__webpack_require__.d=function(e,_){for(var t in _)__webpack_require__.o(_,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:_[t]})}}(),function(){__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){__webpack_require__.o=function(e,_){return Object.prototype.hasOwnProperty.call(e,_)}}(),function(){var e={143:0};__webpack_require__.O.j=function(_){return 0===e[_]};var _=function(_,t){var r,i,o=t[0],a=t[1],n=t[2],l=0;if(o.some((function(_){return 0!==e[_]}))){for(r in a)__webpack_require__.o(a,r)&&(__webpack_require__.m[r]=a[r]);if(n)var c=n(__webpack_require__)}for(_&&_(t);l<o.length;l++)i=o[l],__webpack_require__.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return __webpack_require__.O(c)},t=self["webpackChunkget_onedrive_direct_link"]=self["webpackChunkget_onedrive_direct_link"]||[];t.forEach(_.bind(null,0)),t.push=_.bind(null,t.push.bind(t))}();var __webpack_exports__=__webpack_require__.O(void 0,[998],(function(){return __webpack_require__(6230)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();
//# sourceMappingURL=app.a4175251.js.map
